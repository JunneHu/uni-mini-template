(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["pages/detail/detail"],{"020d":function(e,t,a){"use strict";a.r(t);var r=a("6b43"),n=a.n(r);for(var s in r)"default"!==s&&function(e){a.d(t,e,(function(){return r[e]}))}(s);t["default"]=n.a},"258b":function(e,t,a){"use strict";a.r(t);var r=a("c6c0"),n=a("020d");for(var s in n)"default"!==s&&function(e){a.d(t,e,(function(){return n[e]}))}(s);a("9b61");var i,o=a("f0c5"),c=Object(o["a"])(n["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],i);t["default"]=c.exports},"6b43":function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(a("c0a9")),n=a("a022");function s(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){c(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var u=null,d={data:function(){var e;return e={surplusTime:"",startSecound:"",goodsDetail:{},secondClass:{},passCodeStatus:{},inputs:[],chargeNumList:[],chargeGameList:[],chargeRegionList:[],chargeServerList:[],chargeTypeList:[]},c(e,"chargeNumList",[]),c(e,"tempData",{}),c(e,"postIndex",{numIndex:0,gameIndex:null,regionIndex:null,serverIndex:null,typeIndex:null}),c(e,"orderPost",{}),e},onLoad:function(e){this.gid=e.id,this.pid=e.pid},onShow:function(){this.initGame(),this.getGoodsList()},methods:{getGoodsList:function(){var e=this;(0,n.httpsRequest)(r.default.api.getGoodsList,"GET",{childCategoryId:this.gid},(function(t){if("1000"===t.code){var a=t.data.productList,r={},n=a.find((function(t){return t.productId===e.pid}));r=n||a[0],e.secondClass=t.data,e.goodsDetail=r,e.setGoods()}}))},setGoods:function(){var t=this.goodsDetail,a=this.secondClass;if("直充"==a.productType)t.templateId?(this.initGame(),this.getTemplate()):e.showToast({title:"该商品未配置模板"});else for(var r=0;r<100;r++)this.chargeNumList.push(Number(r+1));if(t&&t.isActivity){t.startSecound&&this.settime(t.startSecound,"startSecound"),t.surplusTime&&this.settime(t.surplusTime,"surplusTime");try{this.userInfo=e.getStorageSync("userInfo"),this.userInfo?this.getPassCodeStatus():this.passCodeStatus={orderNo:"",userPassCodeStatus:3}}catch(n){console.log(n)}}else this.passCodeStatus={orderNo:"",userPassCodeStatus:3}},initGame:function(){this.chargeGameList=[],this.chargeRegionList=[],this.chargeServerList=[],this.chargeTypeList=[],this.chargeNumList=[],this.ChargeGame=[],this.ChargeRegion=[],this.ChargeServer=[],this.ChargeType=[],this.inputs=[],this.tempData={},this.postIndex={numIndex:0,gameIndex:null,regionIndex:null,serverIndex:null,typeIndex:null}},getTemplate:function(){var e=this,t=this.goodsDetail;(0,n.httpsRequest)(r.default.api.getGameProTemp,"GET",{productTemplateId:t.templateId},(function(t){if("1000"==t.code){e.tempData=t.data;e.postIndex;var a=t.data,r=a.isServiceArea,n=a.gameTempaltePreviewList,s=a.elementInfo;if(r){var i=[];n.map((function(e){i.push(e.ChargeGame)})),e.chargeGameList=i,e.ChargeGame=n}else e.tempData={};e.inputs=s.inputs,s&&s.chargeNum?e.mangeNum(s.chargeNum):e.chargeNumList=[]}}),!1)},getPassCodeStatus:function(e){var t=this,a=this.goodsDetail;(0,n.httpsRequest)(r.default.api.getPassCodeStatus,"get",{productId:a.productId},(function(a){"1000"==a.code?t.passCodeStatus=a.data:"1013"!=a.code&&"1014"!=a.code&&"1015"!=a.code||(0,n.toLoginFuLu)().then((function(a){"once"!==e&&t.getPassCodeStatus("once")}))}),!0)},settime:function(e,t){this.countNum=e,this.clearDetailTimeInterval();var a=this;u=setInterval((function(){var e=a.countNum;e-=1,0===e&&(a.clearDetailTimeInterval(),a.getGoodsList()),e>0&&(a.countNum=e,"startSecound"==t?a.startSecound=(0,n.secondToDate)(e):"surplusTime"==t&&(a.surplusTime=(0,n.secondToDate)(e)))}),1e3)},clearDetailTimeInterval:function(){u&&(clearInterval(u),u=null)},choseProduct:function(e){var t=e.currentTarget.dataset.tab,a={},r="",n=this.secondClass;n.productList.map((function(e){e.productId===t&&(a=e,r=t)})),this.goodsDetail=a,this.pid=r,this.setGoods()},mangeNum:function(e){var t=this.goodsDetail,a=[],r=[];e&&(-1!=e.value.indexOf("|")?r=e.value&&e.value.split("|"):r.push(e.value),r.length&&r.map((function(e){if(-1!=e.indexOf("-"))for(var r=e.split("-"),n=r[0];n<=r[1];n++)n<=t.singlePurchaseLimit&&a.push(Number(n));else e<=t.singlePurchaseLimit&&a.push(Number(e))}))),this.chargeNumList=a},changeGame:function(e){var t=e.detail.value,a=this.postIndex,r=this.ChargeGame;a.gameIndex=t;var n=r[t].gameList;if(n){var s=[],i=[],o=[];n.ChargeRegion&&n.ChargeRegion[0]&&n.ChargeRegion.map((function(e){s.push(e.name)})),n.ChargeServer&&n.ChargeServer[0]&&n.ChargeServer.map((function(e){i.push(e.name)})),n.ChargeType&&n.ChargeType[0]&&n.ChargeType.map((function(e){o.push(e.name)})),this.postIndex=a,this.chargeRegionList=s,this.chargeServerList=i,this.chargeTypeList=o,this.ChargeRegion=n.ChargeRegion||[],this.ChargeServer=n.ChargeServer||[],this.ChargeType=n.ChargeType||[]}},changeRegion:function(e){var t=e.detail.value,a=this.ChargeRegion,r=this.postIndex;r.regionIndex=t;var n=a[t];if(this.postIndex=r,n.ChargeServer&&n.ChargeServer[0]){var s=[];n.ChargeServer.map((function(e){s.push(e.name)})),this.chargeServerList=s,this.ChargeServer=n.ChargeServer}if(n.ChargeType&&n.ChargeType[0]){var i=[];n.ChargeType.map((function(e){i.push(e.name)})),this.chargeTypeList=i,this.ChargeType=n.ChargeType}},changeServer:function(e){var t=e.detail.value,a=this.ChargeServer,r=this.postIndex;r.serverIndex=t,this.postIndex=r;var n=a[t];if(n.ChargeType&&n.ChargeType[0]){var s=[];n.ChargeType.map((function(e){s.push(e.name)})),this.chargeTypeList=s,this.ChargeType=n.ChargeType}},changeType:function(e){var t=e.detail.value,a=this.postIndex;a.typeIndex=t,this.postIndex=a},changeNum:function(e){var t=e.detail.value,a=this.postIndex;a.numIndex=t,this.postIndex=a},formSubmit:function(t){var a=this.secondClass,r=t.detail.value,n=t.detail.target.dataset.tab,s=t.detail.target.dataset.orderno;"2"==n?e.navigateTo({url:"/pages/sureOrder/sureOrder?oid=".concat(s)}):"1"==n||"4"==n?"直充"==a.productType?this.sendOrder(r):"卡密"==a.productType&&this.sendKMOrder(r):"3"==n&&this.getPassCode()},getPassCode:function(t){var a=this;try{var s=e.getStorageSync("userInfo");if(s){var i=this.goodsDetail;(0,n.httpsRequest)(r.default.api.getPassCode,"get",{productId:i.productId},(function(r){"1000"==r.code?r.data&&(e.showModal({title:"活动提示",content:"恭喜您，已获得活动名额"}),a.getPassCodeStatus()):"1013"!=r.code&&"1014"!=r.code&&"1015"!=r.code||(0,n.toLoginFuLu)().then((function(e){"once"!==t&&a.getPassCode("once")}))}),!0)}else(0,n.toLoginFuLu)().then((function(e){a.getPassCode()}))}catch(o){console.log(o)}},sendOrder:function(t){var a=this.chargeGameList,r=this.chargeRegionList,n=this.chargeServerList,s=this.chargeTypeList,i=this.chargeNumList,c=this.goodsDetail;this.secondClass;if(console.log("game",t),!t.ChargeAccount)return e.showToast({icon:"none",title:"请输入充值账号"});var u="",d="";if(1==c.validType?(u=/^1(3|4|5|6|7|8|9)\d{9}$/,d="手机号"):2==c.validType?(u=/^[1-9][0-9]{4,9}$/,d="QQ号"):3==c.validType&&(u=/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/,d="邮箱"),u&&!u.test(t.ChargeAccount))return e.showToast({icon:"none",title:"请输入正确格式的".concat(d)});if("ContactType"in t&&!/^1(3|4|5|6|7|8|9)\d{9}$/.test(t.ContactType))return e.showToast({icon:"none",title:"手机号格式错误"});if("ContactQQ"in t&&!/^[1-9][0-9]{4,11}$/.test(t.ContactQQ))return e.showToast({icon:"none",title:"qq格式错误"});if("ChargePWD"in t&&!/^[a-zA-Z0-9_-]{4,16}$/.test(t.ChargePWD))return e.showToast({icon:"none",title:"密码由4到16位（字母，数字，下划线，减号）组成"});if("ChargeWeiXin"in t&&!/^[a-zA-Z]([-_a-zA-Z0-9]{5,19})+$/.test(t.ChargeWeiXin))return e.showToast({icon:"none",title:"微信格式错误"});if("ChargeContacts"in t&&!t.ChargeContacts)return e.showToast({icon:"none",title:"联系人不能为空"});if("ChargeAddress"in t&&!t.ChargeAddress)return e.showToast({icon:"none",title:"联系地址不能为空"});if("ChargeGameName"in t&&!t.ChargeGameName&&0!=t.ChargeGameName)return e.showToast({icon:"none",title:"充值游戏不能为空"});if("ChargeGameRegion"in t&&!t.ChargeGameRegion&&0!=t.ChargeGameRegion)return e.showToast({icon:"none",title:"充值区不能为空"});if("ChargeServer"in t&&!t.ChargeGameSrv&&0!=t.ChargeGameSrv)return e.showToast({icon:"none",title:"充值服不能为空"});if("ChargeType"in t&&!t.ChargeType&&0!=t.ChargeType)return e.showToast({icon:"none",title:"充值类型不能为空"});var h=o({},t,{contactTel:t.ContactType,contactQq:t.ContactQQ,chargeType:t.ChargeType,ChargeGameName:a[t.ChargeGameName],ChargeGameRegion:r[t.ChargeGameRegion],ChargeGameSrv:n[t.ChargeGameSrv],ChargeType:s[t.ChargeType],buyNum:i[t.buyNum]||"1"});console.log("orderPost",h),this.sendOrderFn(h)},sendOrderFn:function(t){var a=this;console.log("---",t);var s=this.orderPost,i=this.goodsDetail,c=this.secondClass;"once"!==t&&"user"!==t&&(s=t,this.orderPost=t);try{var u=e.getStorageSync("userInfo");u?(this.isLoading=!0,(0,n.httpsRequest)(r.default.api.sendOrder,"post",o({},s,{productId:i.productId,salePrice:i.price,childCategoryId:c.childCategoryId}),(function(r){if(a.isLoading=!1,"1000"==r.code)e.navigateTo({url:"/pages/sureOrder/sureOrder?oid=".concat(r.data)});else if(("1013"==r.code||"1014"==r.code||"1015"==r.code)&&"once"!==t)return a.sendOrderFn("once")}),!0)):(0,n.toLoginFuLu)().then((function(e){a.sendOrderFn("user")}))}catch(d){console.log(d)}},sendKMOrder:function(t){var a=this,s=this.goodsDetail,i=this.secondClass,o=this.chargeNumList,c={};console.log("ppp",t),c="once"!==t&&"user"!==t?t:this.orderPost,this.orderPost=c;try{var u=e.getStorageSync("userInfo");u?(this.isLoading=!0,console.log(c,"=="),(0,n.httpsRequest)(r.default.api.sendCardOrder,"post",{buyNum:o[c.buyNum]||"1",extractCode:"123456",productId:s.productId,salePrice:s.price,childCategoryId:i.childCategoryId},(function(r){if(a.isLoading=!1,"1000"==r.code)e.navigateTo({url:"/pages/sureOrder/sureOrder?oid=".concat(r.data)});else if(("1013"==r.code||"1014"==r.code||"1015"==r.code)&&"once"!==t)return a.sendKMOrder("once")}),!0)):(0,n.toLoginFuLu)().then((function(e){a.sendKMOrder("user")}))}catch(d){console.log(d)}},toIndex:function(){e.reLaunch({url:"/pages/index/index"})},toServe:function(){e.navigateTo({url:"/pages/service/service"})},onPullDownRefresh:function(){this.getGoodsList()}}};t.default=d}).call(this,a("c11b")["default"])},"9b61":function(e,t,a){"use strict";var r=a("b244"),n=a.n(r);n.a},b244:function(e,t,a){},c6c0:function(e,t,a){"use strict";var r,n=function(){var e=this,t=e.$createElement;e._self._c},s=[];a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return r}))},eeaf:function(e,t,a){"use strict";(function(e){a("9dae");r(a("66fd"));var t=r(a("258b"));function r(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,a("c11b")["createPage"])}},[["eeaf","common/runtime","common/vendor"]]]);